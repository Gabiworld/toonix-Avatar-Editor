var CNHelpers={detectCSSFeature:function(featurename){var feature=false,domPrefixes="Webkit Moz ms O".split(" "),elm=document.createElement("div"),featurenameCapital=null;featurename=featurename.toLowerCase();if(elm.style[featurename]){feature=true}if(feature===false){featurenameCapital=featurename.charAt(0).toUpperCase()+featurename.substr(1);for(var i=0;i<domPrefixes.length;i++){if(elm.style[domPrefixes[i]+featurenameCapital]!==undefined){feature=true;break}}}return feature},creditsFiller:function(credits){var creditsFiller="000000";credits=(creditsFiller+credits).slice(-creditsFiller.length);return credits},loadImageBase64:function(){var data=new Image();data.onload=data.onerror=function(){if(this.width!=1||this.height!=1){$("#contenido").attr("data-support-base64","false");return}};data.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="},validateSupportBase64:function(){this.loadImageBase64();return($("#contenido").attr("data-support-base64")!="false")}};jQuery.fn.disableForm=function(){$(this).find("button,input[type!=hidden],select,textarea").attr("disabled","disabled");return this};jQuery.fn.enableForm=function(){$(this).find("button,input[type!=hidden],select,textarea").removeAttr("disabled");return this};
/*! http://mths.be/placeholder v2.0.7 by @mathias */
(function(window,document,$){var isInputSupported="placeholder" in document.createElement("input");var isTextareaSupported="placeholder" in document.createElement("textarea");var prototype=$.fn;var valHooks=$.valHooks;var propHooks=$.propHooks;var hooks;var placeholder;if(isInputSupported&&isTextareaSupported){placeholder=prototype.placeholder=function(){return this};placeholder.input=placeholder.textarea=true}else{placeholder=prototype.placeholder=function(){var $this=this;$this.filter((isInputSupported?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":clearPlaceholder,"blur.placeholder":setPlaceholder}).data("placeholder-enabled",true).trigger("blur.placeholder");return $this};placeholder.input=isInputSupported;placeholder.textarea=isTextareaSupported;hooks={get:function(element){var $element=$(element);var $passwordInput=$element.data("placeholder-password");if($passwordInput){return $passwordInput[0].value}return $element.data("placeholder-enabled")&&$element.hasClass("placeholder")?"":element.value},set:function(element,value){var $element=$(element);var $passwordInput=$element.data("placeholder-password");if($passwordInput){return $passwordInput[0].value=value}if(!$element.data("placeholder-enabled")){return element.value=value}if(value==""){element.value=value;if(element!=safeActiveElement()){setPlaceholder.call(element)}}else{if($element.hasClass("placeholder")){clearPlaceholder.call(element,true,value)||(element.value=value)}else{element.value=value}}return $element}};if(!isInputSupported){valHooks.input=hooks;propHooks.value=hooks}if(!isTextareaSupported){valHooks.textarea=hooks;propHooks.value=hooks}$(function(){$(document).delegate("form","submit.placeholder",function(){var $inputs=$(".placeholder",this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder)},10)})});$(window).bind("beforeunload.placeholder",function(){$(".placeholder").each(function(){this.value=""})})}function args(elem){var newAttrs={};var rinlinejQuery=/^jQuery\d+$/;$.each(elem.attributes,function(i,attr){if(attr.specified&&!rinlinejQuery.test(attr.name)){newAttrs[attr.name]=attr.value}});return newAttrs}function clearPlaceholder(event,value){var input=this;var $input=$(input);if(input.value==$input.attr("placeholder")&&$input.hasClass("placeholder")){if($input.data("placeholder-password")){$input=$input.hide().next().show().attr("id",$input.removeAttr("id").data("placeholder-id"));if(event===true){return $input[0].value=value}$input.focus()}else{input.value="";$input.removeClass("placeholder");input==safeActiveElement()&&input.select()}}}function setPlaceholder(){var $replacement;var input=this;var $input=$(input);var id=this.id;if(input.value==""){if(input.type=="password"){if(!$input.data("placeholder-textinput")){try{$replacement=$input.clone().attr({type:"text"})}catch(e){$replacement=$("<input>").attr($.extend(args(this),{type:"text"}))}$replacement.removeAttr("name").data({"placeholder-password":$input,"placeholder-id":id}).bind("focus.placeholder",clearPlaceholder);$input.data({"placeholder-textinput":$replacement,"placeholder-id":id}).before($replacement)}$input=$input.removeAttr("id").hide().prev().attr("id",id).show()}$input.addClass("placeholder");$input[0].value=$input.attr("placeholder")}else{$input.removeClass("placeholder")}}function safeActiveElement(){try{return document.activeElement}catch(err){}}}(this,document,jQuery));jQuery.fn.slider=function(opt){var _opt=$.extend({loop:false,itemListContainer:".items",itemList:".item",nextArrow:".next",pageItemCount:1,previousArrow:".previous",visibleItemCount:6},opt);var $slider=$(this);var $items=$slider.find(_opt.itemListContainer);var $itemList=$items.find(_opt.itemList);var $previousArrow=$slider.find(_opt.previousArrow);var $nextArrow=$slider.find(_opt.nextArrow);var _itemWidth=$itemList.first().outerWidth(true);var _itemCount=$itemList.length;var _currentItem=0;function init(){$items.css({width:(_itemWidth*_itemCount)+"px"});$previousArrow.click(onPreviousArrowClickHandler);$nextArrow.click(onNextArrowClickHandler);updateArrowVisibilityStatus()}function onPreviousArrowClickHandler(){slideToCurrentItem(-1)}function onNextArrowClickHandler(){slideToCurrentItem(1)}function slideToCurrentItem(direction){_currentItem+=direction*_opt.pageItemCount;if(direction==-1){if(_opt.loop&&_currentItem==-_opt.pageItemCount){_currentItem=_itemCount-_opt.visibleItemCount}else{if(_currentItem<0){_currentItem=0}}}else{if(direction==1){if(_opt.loop&&_currentItem==_itemCount-_opt.visibleItemCount+_opt.pageItemCount){_currentItem=0}else{if(_currentItem>_itemCount-_opt.visibleItemCount){_currentItem=_itemCount-_opt.visibleItemCount}}}}$items.stop(true,true).animate({"margin-left":-(_itemWidth*_currentItem)+"px"});updateArrowVisibilityStatus()}function updateArrowVisibilityStatus(){$previousArrow.show();$nextArrow.show();if(_opt.loop){return}if(_currentItem==0){$previousArrow.hide()}if(_currentItem==_itemCount-_opt.visibleItemCount){$nextArrow.hide()}if(_itemCount<_opt.visibleItemCount){$previousArrow.hide();$nextArrow.hide()}}init()};jQuery.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options=$.extend({},options);options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};(function($){$.gritter={};$.gritter.options={fade_in_speed:"medium",fade_out_speed:2000,time:6000};$.gritter.add=function(params){try{if(!params.title||!params.text){throw'You need to fill out the first 2 params: "title" and "text"'}}catch(e){alert("Gritter Error: "+e)}return Gritter.add(params)};$.gritter.remove=function(id,params){Gritter.removeSpecific(id,params||"")};$.gritter.removeAll=function(params){Gritter.stop(params||"")};var Gritter={fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[image]]<div class="[[class_name]]"><span class="gritter-title">[[username]]</span><p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(params){if(!this._is_setup){this._runSetup()}var user=params.title,text=params.text,image=params.image||"",sticky=params.sticky||false,time_alive=params.time||"";this._verifyWrapper();this._item_count++;var number=this._item_count,tmp=this._tpl_item;this["_before_open_"+number]=($.isFunction(params.before_open))?params.before_open:function(){};this["_after_open_"+number]=($.isFunction(params.after_open))?params.after_open:function(){};this["_before_close_"+number]=($.isFunction(params.before_close))?params.before_close:function(){};this["_after_close_"+number]=($.isFunction(params.after_close))?params.after_close:function(){};this._custom_timer=0;if(time_alive){this._custom_timer=time_alive}var image_str=(image!="")?'<img src="'+image+'" class="gritter-image" />':"",class_name=(image!="")?"gritter-with-image":"gritter-without-image";tmp=this._str_replace(["[[username]]","[[text]]","[[image]]","[[number]]","[[class_name]]"],[user,text,image_str,this._item_count,class_name],tmp);this["_before_open_"+number]();$("#gritter-notice-wrapper").append(tmp);var item=$("#gritter-item-"+this._item_count);item.fadeIn(this.fade_in_speed,function(){Gritter["_after_open_"+number]($(this))});if(!sticky){this._setFadeTimer(item,number)}$(item).bind("mouseenter mouseleave",function(event){if(event.type=="mouseenter"){if(!sticky){Gritter.restoreItemIfFading(this,number)}}else{if(!sticky){Gritter._setFadeTimer(this,number)}}Gritter._hoverState(this,event.type)});return number},_countRemoveWrapper:function(unique_id){this["_after_close_"+unique_id]($("#gritter-item-"+unique_id));if($(".gritter-item-wrapper").length==0){$("#gritter-notice-wrapper").remove()}},_fade:function(e,unique_id){Gritter["_before_close_"+unique_id]($(e));$(e).animate({opacity:0},Gritter.fade_out_speed,function(){$(e).animate({height:0},300,function(){$(e).remove();Gritter._countRemoveWrapper(unique_id)})})},_hoverState:function(e,type){if(type=="mouseenter"){$(e).addClass("hover");if($(e).find("img").length){$(e).find("img").before(this._tpl_close)}else{$(e).find("span").before(this._tpl_close)}$(e).find(".gritter-close").click(function(){Gritter._remove(this)})}else{$(e).removeClass("hover");$(e).find(".gritter-close").remove()}},_remove:function(e){var gritter_wrap=$(e).parents(".gritter-item-wrapper");var unique_id=gritter_wrap.attr("id").split("-")[2];this["_before_close_"+unique_id](gritter_wrap);gritter_wrap.fadeOut("medium",function(){$(this).remove();Gritter._countRemoveWrapper(unique_id)})},removeSpecific:function(unique_id,params){var e=$("#gritter-item-"+unique_id);this["_before_close_"+unique_id](e);if(typeof(params)==="object"){if(params.fade){var speed=this.fade_out_speed;if(params.speed){speed=params.speed}e.fadeOut(speed,function(){e.remove()})}}else{e.remove()}this._countRemoveWrapper(unique_id)},restoreItemIfFading:function(e,number){window.clearTimeout(Gritter["_int_id_"+number]);$(e).stop().css({opacity:1})},_runSetup:function(){for(opt in $.gritter.options){this[opt]=$.gritter.options[opt]}this._is_setup=1},_setFadeTimer:function(item,number){var timer_str=(this._custom_timer)?this._custom_timer:this.time;Gritter["_int_id_"+number]=window.setTimeout(function(){Gritter._fade(item,number)},timer_str)},stop:function(params){var before_close=($.isFunction(params.before_close))?params.before_close:function(){};var after_close=($.isFunction(params.after_close))?params.after_close:function(){};var wrap=$("#gritter-notice-wrapper");before_close(wrap);wrap.fadeOut(function(){$(this).remove();after_close()})},_str_replace:function(search,replace,subject,count){var i=0,j=0,temp="",repl="",sl=0,fl=0,f=[].concat(search),r=[].concat(replace),s=subject,ra=r instanceof Array,sa=s instanceof Array;s=[].concat(s);if(count){this.window[count]=0}for(i=0,sl=s.length;i<sl;i++){if(s[i]===""){continue}for(j=0,fl=f.length;j<fl;j++){temp=s[i]+"";repl=ra?(r[j]!==undefined?r[j]:""):r[0];s[i]=(temp).split(f[j]).join(repl);if(count&&s[i]!==temp){this.window[count]+=(temp.length-s[i].length)/f[j].length}}}return sa?s:s[0]},_verifyWrapper:function(){if($("#gritter-notice-wrapper").length==0){$("body").append(this._tpl_wrap)}}}})(jQuery);(function(){var JSTORAGE_VERSION="0.4.5",$=window.jQuery||window.$||(window.$={}),JSON={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(str){return String(str).evalJSON()}||$.parseJSON||$.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||$.toJSON};if(!("parse" in JSON)||!("stringify" in JSON)){throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page")}var _storage={__jstorage_meta:{CRC32:{}}},_storage_service={jStorage:"{}"},_storage_elm=null,_storage_size=0,_backend=false,_observers={},_observer_timeout=false,_observer_update=0,_pubsub_observers={},_pubsub_last=+new Date(),_ttl_timeout,_XMLService={isXML:function(elm){var documentElement=(elm?elm.ownerDocument||elm:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false},encode:function(xmlNode){if(!this.isXML(xmlNode)){return false}try{return new XMLSerializer().serializeToString(xmlNode)}catch(E1){try{return xmlNode.xml}catch(E2){}}return false},decode:function(xmlString){var dom_parser=("DOMParser" in window&&(new DOMParser()).parseFromString)||(window.ActiveXObject&&function(_xmlString){var xml_doc=new ActiveXObject("Microsoft.XMLDOM");xml_doc.async="false";xml_doc.loadXML(_xmlString);return xml_doc}),resultXML;if(!dom_parser){return false}resultXML=dom_parser.call("DOMParser" in window&&(new DOMParser())||window,xmlString,"text/xml");return this.isXML(resultXML)?resultXML:false}};function _init(){var localStorageReallyWorks=false;if("localStorage" in window){try{window.localStorage.setItem("_tmptest","tmpval");localStorageReallyWorks=true;window.localStorage.removeItem("_tmptest")}catch(BogusQuotaExceededErrorOnIos5){}}if(localStorageReallyWorks){try{if(window.localStorage){_storage_service=window.localStorage;_backend="localStorage";_observer_update=_storage_service.jStorage_update}}catch(E3){}}else{if("globalStorage" in window){try{if(window.globalStorage){if(window.location.hostname=="localhost"){_storage_service=window.globalStorage["localhost.localdomain"]}else{_storage_service=window.globalStorage[window.location.hostname]}_backend="globalStorage";_observer_update=_storage_service.jStorage_update}}catch(E4){}}else{_storage_elm=document.createElement("link");if(_storage_elm.addBehavior){_storage_elm.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(_storage_elm);try{_storage_elm.load("jStorage")}catch(E){_storage_elm.setAttribute("jStorage","{}");_storage_elm.save("jStorage");_storage_elm.load("jStorage")}var data="{}";try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}try{_observer_update=_storage_elm.getAttribute("jStorage_update")}catch(E6){}_storage_service.jStorage=data;_backend="userDataBehavior"}else{_storage_elm=null;return}}}_load_storage();_handleTTL();_setupObserver();_handlePubSub();if("addEventListener" in window){window.addEventListener("pageshow",function(event){if(event.persisted){_storageObserver()}},false)}}function _reloadData(){var data="{}";if(_backend=="userDataBehavior"){_storage_elm.load("jStorage");try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}try{_observer_update=_storage_elm.getAttribute("jStorage_update")}catch(E6){}_storage_service.jStorage=data}_load_storage();_handleTTL();_handlePubSub()}function _setupObserver(){if(_backend=="localStorage"||_backend=="globalStorage"){if("addEventListener" in window){window.addEventListener("storage",_storageObserver,false)}else{document.attachEvent("onstorage",_storageObserver)}}else{if(_backend=="userDataBehavior"){setInterval(_storageObserver,1000)}}}function _storageObserver(){var updateTime;clearTimeout(_observer_timeout);_observer_timeout=setTimeout(function(){if(_backend=="localStorage"||_backend=="globalStorage"){updateTime=_storage_service.jStorage_update}else{if(_backend=="userDataBehavior"){_storage_elm.load("jStorage");try{updateTime=_storage_elm.getAttribute("jStorage_update")}catch(E5){}}}if(updateTime&&updateTime!=_observer_update){_observer_update=updateTime;_checkUpdatedKeys()}},25)}function _checkUpdatedKeys(){var oldCrc32List=JSON.parse(JSON.stringify(_storage.__jstorage_meta.CRC32)),newCrc32List;_reloadData();newCrc32List=JSON.parse(JSON.stringify(_storage.__jstorage_meta.CRC32));var key,updated=[],removed=[];for(key in oldCrc32List){if(oldCrc32List.hasOwnProperty(key)){if(!newCrc32List[key]){removed.push(key);continue}if(oldCrc32List[key]!=newCrc32List[key]&&String(oldCrc32List[key]).substr(0,2)=="2."){updated.push(key)}}}for(key in newCrc32List){if(newCrc32List.hasOwnProperty(key)){if(!oldCrc32List[key]){updated.push(key)}}}_fireObservers(updated,"updated");_fireObservers(removed,"deleted")}function _fireObservers(keys,action){keys=[].concat(keys||[]);if(action=="flushed"){keys=[];for(var key in _observers){if(_observers.hasOwnProperty(key)){keys.push(key)}}action="deleted"}for(var i=0,len=keys.length;i<len;i++){if(_observers[keys[i]]){for(var j=0,jlen=_observers[keys[i]].length;j<jlen;j++){_observers[keys[i]][j](keys[i],action)}}if(_observers["*"]){for(var j=0,jlen=_observers["*"].length;j<jlen;j++){_observers["*"][j](keys[i],action)}}}}function _publishChange(){var updateTime=(+new Date()).toString();if(_backend=="localStorage"||_backend=="globalStorage"){try{_storage_service.jStorage_update=updateTime}catch(E8){_backend=false}}else{if(_backend=="userDataBehavior"){_storage_elm.setAttribute("jStorage_update",updateTime);_storage_elm.save("jStorage")}}_storageObserver()}function _load_storage(){if(_storage_service.jStorage){try{_storage=JSON.parse(String(_storage_service.jStorage))}catch(E6){_storage_service.jStorage="{}"}}else{_storage_service.jStorage="{}"}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0;if(!_storage.__jstorage_meta){_storage.__jstorage_meta={}}if(!_storage.__jstorage_meta.CRC32){_storage.__jstorage_meta.CRC32={}}}function _save(){_dropOldEvents();try{_storage_service.jStorage=JSON.stringify(_storage);if(_storage_elm){_storage_elm.setAttribute("jStorage",_storage_service.jStorage);_storage_elm.save("jStorage")}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0}catch(E7){}}function _checkKey(key){if(!key||(typeof key!="string"&&typeof key!="number")){throw new TypeError("Key name must be string or numeric")}if(key=="__jstorage_meta"){throw new TypeError("Reserved key name")}return true}function _handleTTL(){var curtime,i,TTL,CRC32,nextExpire=Infinity,changed=false,deleted=[];clearTimeout(_ttl_timeout);if(!_storage.__jstorage_meta||typeof _storage.__jstorage_meta.TTL!="object"){return}curtime=+new Date();TTL=_storage.__jstorage_meta.TTL;CRC32=_storage.__jstorage_meta.CRC32;for(i in TTL){if(TTL.hasOwnProperty(i)){if(TTL[i]<=curtime){delete TTL[i];delete CRC32[i];delete _storage[i];changed=true;deleted.push(i)}else{if(TTL[i]<nextExpire){nextExpire=TTL[i]}}}}if(nextExpire!=Infinity){_ttl_timeout=setTimeout(_handleTTL,nextExpire-curtime)}if(changed){_save();_publishChange();_fireObservers(deleted,"deleted")}}function _handlePubSub(){var i,len;if(!_storage.__jstorage_meta.PubSub){return}var pubelm,_pubsubCurrent=_pubsub_last;for(i=len=_storage.__jstorage_meta.PubSub.length-1;i>=0;i--){pubelm=_storage.__jstorage_meta.PubSub[i];if(pubelm[0]>_pubsub_last){_pubsubCurrent=pubelm[0];_fireSubscribers(pubelm[1],pubelm[2])}}_pubsub_last=_pubsubCurrent}function _fireSubscribers(channel,payload){if(_pubsub_observers[channel]){for(var i=0,len=_pubsub_observers[channel].length;i<len;i++){try{_pubsub_observers[channel][i](channel,JSON.parse(JSON.stringify(payload)))}catch(E){}}}}function _dropOldEvents(){if(!_storage.__jstorage_meta.PubSub){return}var retire=+new Date()-2000;for(var i=0,len=_storage.__jstorage_meta.PubSub.length;i<len;i++){if(_storage.__jstorage_meta.PubSub[i][0]<=retire){_storage.__jstorage_meta.PubSub.splice(i,_storage.__jstorage_meta.PubSub.length-i);break}}if(!_storage.__jstorage_meta.PubSub.length){delete _storage.__jstorage_meta.PubSub}}function _publish(channel,payload){if(!_storage.__jstorage_meta){_storage.__jstorage_meta={}}if(!_storage.__jstorage_meta.PubSub){_storage.__jstorage_meta.PubSub=[]}_storage.__jstorage_meta.PubSub.unshift([+new Date,channel,payload]);_save();_publishChange()}function murmurhash2_32_gc(str,seed){var l=str.length,h=seed^l,i=0,k;while(l>=4){k=((str.charCodeAt(i)&255))|((str.charCodeAt(++i)&255)<<8)|((str.charCodeAt(++i)&255)<<16)|((str.charCodeAt(++i)&255)<<24);k=(((k&65535)*1540483477)+((((k>>>16)*1540483477)&65535)<<16));k^=k>>>24;k=(((k&65535)*1540483477)+((((k>>>16)*1540483477)&65535)<<16));h=(((h&65535)*1540483477)+((((h>>>16)*1540483477)&65535)<<16))^k;l-=4;++i}switch(l){case 3:h^=(str.charCodeAt(i+2)&255)<<16;case 2:h^=(str.charCodeAt(i+1)&255)<<8;case 1:h^=(str.charCodeAt(i)&255);h=(((h&65535)*1540483477)+((((h>>>16)*1540483477)&65535)<<16))}h^=h>>>13;h=(((h&65535)*1540483477)+((((h>>>16)*1540483477)&65535)<<16));h^=h>>>15;return h>>>0}$.jStorage={version:JSTORAGE_VERSION,set:function(key,value,options){_checkKey(key);options=options||{};if(typeof value=="undefined"){this.deleteKey(key);return value}if(_XMLService.isXML(value)){value={_is_xml:true,xml:_XMLService.encode(value)}}else{if(typeof value=="function"){return undefined}else{if(value&&typeof value=="object"){value=JSON.parse(JSON.stringify(value))}}}_storage[key]=value;_storage.__jstorage_meta.CRC32[key]="2."+murmurhash2_32_gc(JSON.stringify(value),2538058380);this.setTTL(key,options.TTL||0);_fireObservers(key,"updated");return value},get:function(key,def){_checkKey(key);if(key in _storage){if(_storage[key]&&typeof _storage[key]=="object"&&_storage[key]._is_xml){return _XMLService.decode(_storage[key].xml)}else{return _storage[key]}}return typeof(def)=="undefined"?null:def},deleteKey:function(key){_checkKey(key);if(key in _storage){delete _storage[key];if(typeof _storage.__jstorage_meta.TTL=="object"&&key in _storage.__jstorage_meta.TTL){delete _storage.__jstorage_meta.TTL[key]}delete _storage.__jstorage_meta.CRC32[key];_save();_publishChange();_fireObservers(key,"deleted");return true}return false},setTTL:function(key,ttl){var curtime=+new Date();_checkKey(key);ttl=Number(ttl)||0;if(key in _storage){if(!_storage.__jstorage_meta.TTL){_storage.__jstorage_meta.TTL={}}if(ttl>0){_storage.__jstorage_meta.TTL[key]=curtime+ttl}else{delete _storage.__jstorage_meta.TTL[key]}_save();_handleTTL();_publishChange();return true}return false},getTTL:function(key){var curtime=+new Date(),ttl;_checkKey(key);if(key in _storage&&_storage.__jstorage_meta.TTL&&_storage.__jstorage_meta.TTL[key]){ttl=_storage.__jstorage_meta.TTL[key]-curtime;return ttl||0}return 0},flush:function(){_storage={__jstorage_meta:{CRC32:{}}};_save();_publishChange();_fireObservers(null,"flushed");return true},storageObj:function(){function F(){}F.prototype=_storage;return new F()},index:function(){var index=[],i;for(i in _storage){if(_storage.hasOwnProperty(i)&&i!="__jstorage_meta"){index.push(i)}}return index},storageSize:function(){return _storage_size},currentBackend:function(){return _backend},storageAvailable:function(){return !!_backend},listenKeyChange:function(key,callback){_checkKey(key);if(!_observers[key]){_observers[key]=[]}_observers[key].push(callback)},stopListening:function(key,callback){_checkKey(key);if(!_observers[key]){return}if(!callback){delete _observers[key];return}for(var i=_observers[key].length-1;i>=0;i--){if(_observers[key][i]==callback){_observers[key].splice(i,1)}}},subscribe:function(channel,callback){channel=(channel||"").toString();if(!channel){throw new TypeError("Channel not defined")}if(!_pubsub_observers[channel]){_pubsub_observers[channel]=[]}_pubsub_observers[channel].push(callback)},publish:function(channel,payload){channel=(channel||"").toString();if(!channel){throw new TypeError("Channel not defined")}_publish(channel,payload)},reInit:function(){_reloadData()}};_init()})();var CNSessionController={$document:null,$userBar:null,$proxyIframe:null,needsProxy:false,userData:null,serviceURL:null,proxyServiceURL:null,store:null,storeKey:"userData",ttl:60,isLogginIn:false,hashedPassword:null,SWFCallback:null,init:function(){this.$document=$(document);this.$userBar=$("#userBar");this.needsProxy=!$.support.cors;this.serviceURL=this.$userBar.attr("data-service-url");this.$document.one("storage.load",$.proxy(this.onStorageLoaded,this))},userLogin:function(userData,callback){if(this.isLogginIn||userData.username===""||userData.password===""){return}this.isLogginIn=true;this.hashedPassword=md5(userData.password);userData.username=userData.username.toLowerCase();userData.password=this.hashedPassword;userData.serviceURL=this.serviceURL;userData=$.param(userData);this.SWFCallback=typeof callback==="function"?callback:null;if(this.needsProxy){this.proxy(userData)}else{$.ajax({url:this.serviceURL,type:"POST",data:userData,dataType:"json",cache:true,success:$.proxy(this.onUserLogin,this)})}},userLogout:function(){gigya.socialize.logout({callback:$.proxy(this.onGigyaUserLogout,this)})},getUserInfo:function(){var $avatarPartsElem=$("#avatarParts"),attrs=["body","bodyColor","costume","eye","head","headColor","imagePath","mouth","skinColor"],userInfo=null,avatarParts={};if(this.isUserLoggedIn()){userInfo={id:this.getUserId(),userName:this.getUserName(),password:this.getUserHashedPassword(),gender:this.getUserGender(),age:this.getUserAge(),birthdate:this.getUserBirthdate(),email:this.getUserEmail(),parentEmail:this.getUserEmailParent(),registerCountryCode:this.getUserRegisterCountryCode(),residentCountryCode:this.getUserResidentCountryCode(),credits:this.getUserCredits(),avatar:this.getUserAvatar()}}else{if($avatarPartsElem.length>0){for(var attr in attrs){if(attrs.hasOwnProperty(attr)){avatarParts[attrs[attr]]=$avatarPartsElem.attr("data-user-avatar-"+attrs[attr])}}userInfo={avatar:avatarParts}}}return userInfo},getUserId:function(){return this.userData.id},getUserName:function(){return this.userData.username},getUserHashedPassword:function(){return this.userData.password},getUserGender:function(){return this.userData.gender},getUserAge:function(){return this.userData.age},getUserBirthdate:function(){return this.userData.birthdate},getUserEmail:function(){return this.userData.email},getUserEmailParent:function(){var emailParent=this.userData.parentEmail,email;email=(typeof emailParent!==undefined||emailParent!==null)?this.userData.parentEmail:"";return email},getUserRegisterCountryCode:function(){return this.userData.registerCountryCode},getUserResidentCountryCode:function(){return this.userData.residentCountryCode},getUserCredits:function(){return this.userData.credits},setUserCredits:function(credits){if(this.isUserLoggedIn()){this.userData.credits=credits;this.store.set(this.storeKey,this.userData,this.ttl)}},getUserAvatar:function(){return{body:this.userData.avatarBody,bodyColor:parseInt(this.userData.avatarBodyColor,10),costume:this.userData.avatarCostume,eye:this.userData.avatarEye,head:this.userData.avatarHead,headColor:parseInt(this.userData.avatarHeadColor,10),imagePath:this.userData.avatarImagePath,mouth:this.userData.avatarMouth,skinColor:parseInt(this.userData.avatarSkinColor,10)}},setUserAvatar:function(avatar,avatarBase64){var userData=this.userData;userData.avatarBody=avatar.body;userData.avatarBodyColor=parseInt(avatar.bodyColor,10);userData.avatarCostume=avatar.costume;userData.avatarEye=avatar.eye;userData.avatarHead=avatar.head;userData.avatarHeadColor=parseInt(avatar.headColor,10);userData.avatarImagePath="data:image/png;base64,"+avatarBase64;userData.avatarMouth=avatar.mouth;userData.avatarSkinColor=parseInt(avatar.skinColor,10);this.store.set(this.storeKey,userData,this.ttl)},isUserLoggedIn:function(){return this.userData!==null},onUserLogin:function(r){var SWFDataObject={statusCode:"OK",user:null};this.isLogginIn=false;if(!r){LightboxController.open("lightboxUsuarioInexistente")}else{if(r.error){switch(r.error){case"USER_DISABLED":case"USER_NOT_EXISTS":LightboxController.open("lightboxUsuarioInexistente");break;case"USER_WRONG_PASSWORD":LightboxController.open("lightboxRecuperaDatos");break}}else{if(r.success){r.principal.password=this.hashedPassword;r.principal.age=moment().diff(r.principal.birthdate,"years");this.userData=this.store.set(this.storeKey,r.principal,this.ttl);GigyaController.setCookie(r.principal.cookieUser);trackUserLogin({loginStatus:"logged-in",gender:this.userData.gender.toLowerCase(),age:this.userData.age,country:this.userData.registerCountryCode});this.dispatchEvent()}}}if(this.SWFCallback!==null){SWFDataObject.statusCode=r.error?r.error:"OK";SWFDataObject.user=this.getUserInfo();this.SWFCallback(SWFDataObject)}},onGigyaUserLogout:function(r){if(r.errorCode===0){this.store.deleteKey(this.storeKey);this.userData=null;window.location=CNConfig.domain}},onStorageLoaded:function(e,store){var isLogged;this.store=store;this.userData=this.store.get(this.storeKey);isLogged=this.isUserLoggedIn();if(!isLogged&&this.needsProxy){this.createProxy()}else{if(isLogged){this.store.setTTL(this.storeKey,this.ttl)}}this.dispatchEvent()},dispatchEvent:function(){this.$document.trigger("session.status",this)},assignNewValuesToUserData:function(avatar,avatarImageBase64){var user=LocalStorageController.get("userData");user.avatarBody=avatar.body;user.avatarBodyColor=avatar.bodyColor;user.avatarCostume=avatar.costume;user.avatarEye=avatar.eye;user.avatarHead=avatar.head;user.avatarHeadColor=avatar.headColor;if(CNHelpers.validateSupportBase64()){user.avatarImagePath=avatarImageBase64}user.avatarMouth=avatar.mouth;user.avatarSkinColor=avatar.skinColor;LocalStorageController.set("userData",user,this.ttl)},createProxy:function(){var regex=/^(http[s]?:\/\/[\w\d\.\-:]+)\//,iframe_id="proxy-iframe";this.proxyServiceURL=this.serviceURL.match(regex)[1];this.$proxyIframe=$("#"+iframe_id);if(this.$proxyIframe.length===0){this.$proxyIframe=$("<iframe />");this.$proxyIframe.attr({id:"proxy-iframe","class":"invisible",width:0,height:0,src:this.proxyServiceURL+"/proxy"});$("body").append(this.$proxyIframe)}$(window).on("message",$.proxy(this.onCORSMessage,this))},proxy:function(data){this.$proxyIframe[0].contentWindow.postMessage(data,this.proxyServiceURL)},onCORSMessage:function(r){if(r&&typeof r.originalEvent!=="undefined"){if(r.originalEvent.origin!==this.proxyServiceURL){return}r=$.parseJSON(r.originalEvent.data);if(r.serviceURL===this.serviceURL){this.onUserLogin(r)}}}};(function(w,d,$,CNLAGames,CNConfig,s,trackGameUserCodes){var $document=$(d),sessionController,isLoggedIn,creditsAmount;function _createToken(callback){var ajaxOptions={url:CNConfig.creditsServiceURL.createToken,cache:false,success:callback};$.ajax(ajaxOptions)}function _addCredit(encryptToken,amount,reason){var ajaxOptions={url:CNConfig.creditsServiceURL.addCredit,type:"POST",cache:false,success:_onAddCredit};if(isLoggedIn){creditsAmount=sessionController.getUserCredits()+amount;ajaxOptions.data={userId:sessionController.getUserId(),encryptToken:encryptToken,amount:amount,reason:reason};$.ajax(ajaxOptions)}}function _addPromotionalCode(promotionalCode,callback){var ajaxOptions={url:CNConfig.creditsServiceURL.addPromotionalCode,type:"POST",cache:false,success:function(data){_onAddPromotionalCode(data,promotionalCode,callback)}};if(isLoggedIn){ajaxOptions.data={userId:sessionController.getUserId(),promotionalCode:promotionalCode};$.ajax(ajaxOptions)}}function _dispatchEvent(){CNLAGames.notifyAction("Sys_EnterCode");$document.trigger("credits.update",creditsAmount)}function _onSessionStatus(e,session){sessionController=session;isLoggedIn=session.isUserLoggedIn()}function _onAddCredit(data){if(data!=="false"){sessionController.setUserCredits(creditsAmount);_dispatchEvent()}}function _onAddPromotionalCode(data,promotionalCode,callback){var userData=sessionController.getUserInfo();if(!data.error){userData={loginStatus:"logged-in",gender:userData.gender.toLowerCase(),age:userData.age,country:userData.registerCountryCode};creditsAmount=data.credits;sessionController.setUserCredits(creditsAmount);trackGameUserCodes(s.pageName,"PromotionalCode",promotionalCode,userData);_dispatchEvent()}callback(data)}w.CreditsController={createToken:_createToken,addCredit:_addCredit,addPromotionalCode:_addPromotionalCode};$document.on("session.status",_onSessionStatus)}(window,document,jQuery,CNLAGames,CNConfig,s,trackGameUserCodes));var LightboxController={$lightbox:null,$overlay:null,init:function(id,config){var $lightbox=$("#"+id);$lightbox.find(config.close.join(",")).on("click",$.proxy(this.onCerrarButtonClickHandler,this,id))},onCerrarButtonClickHandler:function(id){this.close(id)},close:function(){var $this=LightboxController;$this.$lightbox.hide();$this.$lightbox.find(".lightbox").stop(true,true).hide();$this.$overlay.stop(true,true).hide()},open:function(id){var $this=LightboxController;if($this.$lightbox==null){$this.$lightbox=$("#lightbox")}if($this.$overlay==null){$this.$overlay=this.$lightbox.find(".overlay")}$this.$lightbox.show();$this.$overlay.stop(true,true).fadeIn();$this.$lightbox.find(".lightbox").stop(true,true).hide();$this.$lightbox.find("#"+id).fadeIn()}};function LightboxRecuperaDatosController(s){this.selector=s}LightboxRecuperaDatosController.prototype.init=function(){this.$recupera=$(this.selector);this.$recuperaForm=this.$recupera.find("form");this.$recuperaUser=this.$recupera.find(".user");this.$recuperaUserInput=this.$recuperaUser.find("[name=user]");this.$recuperaMail=this.$recupera.find(".mail");this.$recuperaMailInput=this.$recuperaMail.find("[name=mail]");this.$recuperaUserInput.placeholder();this.$recuperaMailInput.placeholder();this.$recupera.find(".cerrar-btn").click($.proxy(this.onCloseButtonClickHandler,this));this.$recupera.find(".enviar-btn").click($.proxy(this.onRecuperarDatosButtonClickHandler,this))};LightboxRecuperaDatosController.prototype.onCloseButtonClickHandler=function(){this.$recuperaUser.removeClass("user-error");this.$recuperaUserInput.val("").change();this.$recuperaMail.removeClass("mail-error");this.$recuperaMailInput.val("").change();LightboxController.close()};LightboxRecuperaDatosController.prototype.onRecuperarDatosButtonClickHandler=function(){this.$recuperaUser.removeClass("user-error");this.$recuperaMail.removeClass("mail-error");var errors=false;var username=this.$recuperaUserInput.val();var mail=this.$recuperaMailInput.val();if(username.length<4||username.length>12){this.$recuperaUser.addClass("user-error");errors=true}if(!UserUtilController.isValidEmail(mail)){this.$recuperaMail.addClass("mail-error");errors=true}if(errors){return}this.$recuperaForm.disableForm();$.ajax({url:this.$recuperaForm.attr("action"),data:{username:username,mail:mail},success:$.proxy(this.onRecuperarDatosCompleteHandler,this)})};LightboxRecuperaDatosController.prototype.onRecuperarDatosCompleteHandler=function(r){this.$recuperaForm.enableForm();if(!r){return}if(!r.existsUsername){this.$recuperaUser.addClass("user-error")}if(!r.existsEmail){this.$recuperaMail.addClass("mail-error")}if(r.existsUsername&&r.existsEmail){this.$recupera.find(".recuperar-datos-form").hide();this.$recupera.find(".recuperar-datos-exito").show()}};function LightboxEditAvatarWithoutAccountController(s){this.selector=s}LightboxEditAvatarWithoutAccountController.prototype.init=function(){this.$recupera=$(this.selector);this.$recuperaForm=this.$recupera.find("form");this.$recuperaUser=this.$recupera.find(".user");this.$recuperaUserInput=this.$recuperaUser.find("[name=user]");this.$recuperaPassword=this.$recupera.find(".password");this.$recuperaPasswordInput=this.$recuperaPassword.find("[name=password]");this.$registerlink=this.$recupera.find(".quiero-crear-mi-toonix-btn");this.$registerForm=this.$recupera.find("#save-avatar-and-register");this.$registerAvatarInput=this.$registerForm.find("[name=avatar]");this.$recuperaUserInput.placeholder();this.$recuperaPasswordInput.placeholder();this.$recupera.find(".cerrar-btn").click($.proxy(this.onCloseButtonClickHandler,this));this.$recupera.find(".enviar-btn").click($.proxy(this.onLoginButtonClickHandler,this));this.$registerlink.click($.proxy(this.onRegisterButtonClickHandler,this))};LightboxEditAvatarWithoutAccountController.prototype.onCloseButtonClickHandler=function(){this.$recuperaUser.removeClass("user-error");this.$recuperaUserInput.val("").change();this.$recuperaPassword.removeClass("mail-error");this.$recuperaPasswordInput.val("").change();LightboxController.close()};LightboxEditAvatarWithoutAccountController.prototype.onRegisterButtonClickHandler=function(e){e.preventDefault();this.$registerAvatarInput.val($.param(SocialContentController.avatarEditTemp));LocalStorageController.set("avatarSocialTemp",SocialContentController.avatarEditTemp,this.ttl);$("#save-avatar-and-register").submit()};LightboxEditAvatarWithoutAccountController.prototype.onLoginButtonClickHandler=function(){var userData={username:this.$recuperaUserInput.val(),password:this.$recuperaPasswordInput.val()};CNSessionController.userLogin(userData);$(document).on("session.status",$.proxy(this.onRecuperarDatosCompleteHandler,this))};LightboxEditAvatarWithoutAccountController.prototype.onRecuperarDatosCompleteHandler=function(e,session){if(session.isUserLoggedIn()){SocialContentController.saveSocialAvatar();LightboxController.close()}};var LightboxCreditsPopupController={$lightbox:null,$buttonAddCreditsSMS:null,$buttonAddCode:null,$buttonSendCode:null,$buttonCancelCode:null,$buttonSuccessSMS:null,$buttonTerms:null,$buttonTermsCancel:null,$formPromoCode:null,$codeWrapper:null,$smsWrapper:null,$termsWrapper:null,$screenOptions:null,$errors:[],init:function(){this.initPopup()},open:function(){LightboxController.open("lightboxCreditsPopup")},onCloseButtonClickHandler:function(){this.initPromoCodeForm();this.close()},close:function(){this.clear();LightboxController.close()},clear:function(){this.$codeWrapper.hide();this.$smsWrapper.hide();this.$termsWrapper.hide();this.$screenOptions.show()},onAddCodeButtonClickHandler:function(){this.$codeWrapper.show();this.$screenOptions.hide()},onAddSMSButtonClickHandler:function(){this.$smsWrapper.show();this.$screenOptions.hide()},onSuccessSMSButtonClickHandler:function(){this.$smsWrapper.hide();this.$termsWrapper.hide()},onTermsButtonClickHandler:function(){this.$smsWrapper.hide();this.$termsWrapper.show()},onTermsCancelClickHandler:function(){this.$termsWrapper.hide();this.$smsWrapper.show();this.$screenOptions.hide()},onCodeCancelClickHandler:function(){this.initPromoCodeForm();this.$codeWrapper.hide();this.$screenOptions.show()},onCodeSendClickHandler:function(){this.hideMessages();this.$errors=[];this.validateFromBrowser();if(this.$errors.length>0){return}this.submitPromoCodeForm()},submitPromoCodeForm:function(){var $inputPromoCode=this.$formPromoCode.find("input[name=code]"),promotionalCode=$inputPromoCode.val();$inputPromoCode.val("");CreditsController.addPromotionalCode(promotionalCode,$.proxy(this.handleResponse,this))},handleResponse:function(response){var class_code_error=null;if(response.error!=undefined&&response.error!=""){$(".success_load_promo_code").hide();class_code_error=(response.error).replace(/\./g,"_");$("."+class_code_error).show();$(".code_input .error").show()}else{this.hideErrors();$(".success_load_promo_code").show()}},validateMinCharacters:function(){return($("input[name=code]").val().length>5)},validateFromBrowser:function(){if(!this.validateMinCharacters()){this.showErrorMinCharacters();this.$errors.push("error_min_characters")}},showErrorMinCharacters:function(){$(".promotional_code_min_characters").show();$(".code_input .error").show()},resetForm:function(){this.$formPromoCode.find("input[name=code]").val("")},hideErrors:function(){$(".error_promo_code").hide();$(".code_input .error").hide()},hideMessages:function(){$(".success_load_promo_code").hide();this.hideErrors()},initPromoCodeForm:function(){this.resetForm();this.hideErrors();this.hideMessages()},initializeListeners:function(){this.$lightbox.find(".cerrar-btn").click($.proxy(this.onCloseButtonClickHandler,this));this.$buttonAddCode.click($.proxy(this.onAddCodeButtonClickHandler,this));this.$buttonAddCreditsSMS.click($.proxy(this.onAddSMSButtonClickHandler,this));this.$buttonSuccessSMS.click($.proxy(this.onSuccessSMSButtonClickHandler,this));this.$buttonTerms.click($.proxy(this.onTermsButtonClickHandler,this));this.$buttonTermsCancel.click($.proxy(this.onTermsCancelClickHandler,this));this.$buttonCancelCode.click($.proxy(this.onCodeCancelClickHandler,this));this.$buttonSendCode.click($.proxy(this.onCodeSendClickHandler,this))},initButtons:function(){this.$buttonAddCreditsSMS=this.$lightbox.find(".btn-add-sms");this.$buttonAddCode=this.$lightbox.find(".btn-add-code");this.$buttonSendCode=this.$formPromoCode.find(".enviar-btn");this.$buttonCancelCode=this.$lightbox.find(".btn-load-code-cancel");this.$buttonSuccessSMS=this.$lightbox.find(".load-success-sms");this.$buttonTerms=this.$lightbox.find(".btn-terms");this.$buttonTermsCancel=this.$lightbox.find(".btn-terms-cancel")},initContainerScreens:function(){this.$codeWrapper=this.$lightbox.find(".load_code_container");this.$smsWrapper=this.$lightbox.find(".add-credits-sms");this.$termsWrapper=this.$lightbox.find(".terms");this.$screenOptions=this.$lightbox.find(".screen_1")},initPopup:function(){this.$lightbox=$("#lightboxCreditsPopup");this.$formPromoCode=this.$lightbox.find("#promotional-code-modal");this.initContainerScreens();this.initButtons();this.initializeListeners()}};(function($){var $navMenu=$("#nav-menu");function _init(){var $navMenuBtn,$navMenuBtns;$navMenuBtn=$navMenu.find("#nav-menu-btn");$navMenuBtns=$navMenuBtn.find("span");$navMenu.addClass("closed");$navMenuBtns.addClass("pointer");$navMenuBtn.click(_toggleStatus)}function _toggleStatus(e){e.preventDefault();$navMenu.toggleClass("closed")}_init()}(jQuery));(function(w,d,$,CNLAGames,CNConfig,trackSiteSearch){var $searchBarInput,$searchBarClear,userData;function _init(){var $searchBar=$("#searchBar");$searchBarInput=$searchBar.find("input");$searchBarClear=$searchBar.find(".bt-x");$searchBarInput.on({keyup:_onKeyUp,change:_onChange}).placeholder();$searchBarClear.click(_onClick);$(d).on("session.status",_onSessionStatus)}function _onKeyUp(e){var queryString;if(e.keyCode===13){queryString=$searchBarInput.val();trackSiteSearch(queryString,userData);CNLAGames.notifyAction("Sys_SearchContent");w.location.href=CNConfig.domain+"#/"+queryString}}function _onChange(e){if($searchBarInput.val().length>0){$searchBarClear.removeClass("hide")}else{$searchBarClear.addClass("hide")}}function _onClick(e){$searchBarInput.val("").change()}function _onSessionStatus(e,session){if(session.isUserLoggedIn()){userData={loginStatus:"logged-in",gender:session.getUserGender(),age:session.getUserAge(),country:session.getUserRegisterCountryCode()}}}_init()}(window,document,jQuery,CNLAGames,CNConfig,trackSiteSearch));var LocalStorageController={store:null,init:function(){if(!$.jStorage){setTimeout($.proxy(this.init,this),100)}else{this.store=$.jStorage;this.dispatchLoad()}},get:function(key){return this.store.get(key)},set:function(key,value,ttl){ttl=isNaN(ttl)?"":{TTL:(ttl*60000)};return this.store.set(key,value,ttl)},deleteKey:function(key){return this.store.deleteKey(key)},setTTL:function(key,ttl){ttl=isNaN(ttl)?"":(ttl*60000);return this.store.setTTL(key,ttl)},getTTL:function(key){return parseInt(this.store.getTTL(key)/60000)},flush:function(){return this.store.flush()},index:function(){return this.store.index()},storageSize:function(){return this.store.storageSize()},reInit:function(){this.store.reInit()},storageAvailable:function(){return this.store.storageAvailable()},dispatchLoad:function(){$(document).trigger("storage.load",this)}};(function(w,$,moment,CNLALibrary,CNConfig){var $nowOnCartoon=$("#nowOnCartoon"),$image=$nowOnCartoon.find(".image img"),$hour=$nowOnCartoon.find(".hora"),$name=$nowOnCartoon.find(".nombre"),placeholder=$image.attr("src"),isPAN=(CNConfig.scheduleFeed==="CNLA_PAN"),currentTime;function _show(show,hour){var image=show.image;$image.attr("src",image||placeholder);$hour.html(hour);$name.html(show.title);$nowOnCartoon.removeClass("loading");w.setTimeout(_getShowOnAir,(5*60)*1000)}function _getShowOnAir(){var ajaxOptions={url:"http://schedule.turner.com/show-today-at",data:{feed:CNConfig.scheduleFeed,output:"json",mapped:"true"},dataType:"jsonp",jsonpCallback:"nowOnCartoon",cache:true,success:_onShowTodayAt},config;if(isPAN){config={type:"feed"}}else{config={type:"country",country:CNConfig.feed}}CNLALibrary.getTime(config,_onGetTime);ajaxOptions.data.time=currentTime;$.ajax(ajaxOptions)}function _onGetTime(time){var hours,minutes;hours=time.format("HH");minutes=time.format("mm");if(minutes<15){minutes="00"}else{if(minutes<30){minutes="15"}else{if(minutes<45){minutes="30"}else{minutes="45"}}}currentTime=hours+":"+minutes+":00"}function _onShowTodayAt(show){var hour;if(show){show=show["com.turner.dmtla.schedule.dto.ShowDTO"];hour=moment.tz(show.airDateTime,CNConfig.scheduleTimezoneID);if(isPAN){hour=hour.tz(CNConfig.feedTimezoneID)}hour=hour.format("HH:mm");_show(show,hour)}}_getShowOnAir()}(window,jQuery,moment,CNLALibrary,CNConfig));(function(d,$,CNSessionController,LightboxController){var $navBarForm=$("#navbar_login_form"),$navBarFormUsername=$navBarForm.find("#navbar_login_form_usuario"),$navBarFormPassword=$navBarForm.find("#navbar_login_form_password");function _init(){$navBarFormUsername.placeholder();$navBarFormPassword.placeholder();$navBarForm.on("click keypress",_onEvent);$(d).on("session.status",_onSessionStatus)}function _show(show){$navBarForm.toggle(show)}function _showHelp(){LightboxController.open("lightboxRecuperaDatos")}function _send(){var userData={username:$navBarFormUsername.val(),password:$navBarFormPassword.val()};if(userData.username!==""&&userData.password!==""){$navBarFormUsername.val("");$navBarFormPassword.val("");CNSessionController.userLogin(userData)}else{LightboxController.open("lightboxUsuarioInexistente")}}function _onEvent(e){switch(e.type){case"click":_onClick(e);break;case"keypress":_onKeyPress(e);break;default:break}}function _onClick(e){var $target=$(e.target);if($target.hasClass("enviar-btn")){_send()}else{if($target.hasClass("ayuda-btn")){_showHelp()}}}function _onKeyPress(e){if(e.which===13){_send()}}function _onSessionStatus(e,session){_show(!session.isUserLoggedIn())}_init()}(document,jQuery,CNSessionController,LightboxController));(function(d,$,CNSessionController,ChallengesController,LightboxCreditsPopupController,CNHelpers){var $userBar=$("#navbar_logueado_form"),isLoggedIn;function _init(){$userBar.on("click",_onEvent);$(d).on("session.status challenges.allAchievementList credits.update",_onEvent)}function _show(session){var $userAvatar=$userBar.find(".img_avatar"),credits,avatarImage;if(isLoggedIn){credits=session.getUserCredits();avatarImage=session.getUserAvatar().imagePath;$userAvatar.find("img").attr("src",avatarImage);_showCredits(credits)}$userBar.toggle(isLoggedIn)}function _showCredits(credits){var $userCredits=$userBar.find(".puntos p");credits=CNHelpers.creditsFiller(credits);$userCredits.text(credits)}function _showAchievements(allAchievementsList){var $userAchievements=$userBar.find(".medallas"),achievements_count=allAchievementsList.length;$userAchievements.text(achievements_count).removeClass("invisible")}function _showLevelBar(){var $userLevel=$userBar.find(".containerBarra"),$userLevelBar=$userLevel.find(".barrita"),$userLevelBarLoad=$userLevelBar.find(".barracarga"),$userLevelBarCount=$userLevelBar.find(".cantidad"),$userLevelName=$userLevel.find(".nombre"),defaultAchievement=ChallengesController.getAchievementByChallengeId("_default"),userLevelBarCountStr=$userLevelBarCount.text(),level;level=defaultAchievement.level!==0?defaultAchievement.level%5:-1;if(level===-1){return}else{if(level===0){level=5}}userLevelBarCountStr=userLevelBarCountStr.replace(/\d/,level);$userLevelBarCount.text(userLevelBarCountStr);$userLevelBarLoad.addClass("level"+level);$userLevelName.text(defaultAchievement.levelTitle);$userLevel.removeClass("invisible")}function _openCreditsPopup(){LightboxCreditsPopupController.open()}function _logout(){CNSessionController.userLogout()}function _onEvent(e,extraParams){switch(e.type){case"click":_onClick(e);break;case"session":_onSessionStatus(e,extraParams);break;case"challenges":_onAllAchievementList(e,extraParams);break;case"credits":_onCreditsUpdate(e,extraParams);break;default:break}}function _onClick(e){var $target=$(e.target);if($target.hasClass("bt-tuscreditos")){_openCreditsPopup()}else{if($target.hasClass("bt-cerrar")){_logout()}}}function _onSessionStatus(e,session){isLoggedIn=session.isUserLoggedIn();_show(session)}function _onAllAchievementList(e,allAchievementList){if(isLoggedIn){_showAchievements(allAchievementList);_showLevelBar()}}function _onCreditsUpdate(e,credits){_showCredits(credits)}_init()}(document,jQuery,CNSessionController,ChallengesController,LightboxCreditsPopupController,CNHelpers));var A1ItemsController={ITEM_COUNT:4,PICKERPLACES_IN_A1:4,amountPickersAvailable:null,currentItem:null,$a1:null,$itemList:null,$animationList:null,$activeItem:null,init:function(){this.$a1=$("#a1");this.$a1.find(".switcher").show();this.$itemList=this.$a1.find(".personaje");this.$animationList=this.$a1.find(".animacion");this.amountPickersAvailable=this.$itemList.length;(this.ITEM_COUNT>=this.$itemList.length)?(this.ITEM_COUNT=this.$itemList.length-1):"";if(this.isEmptyListPickerItem()){return}this.initPickerItems();this.showNextItem()},isEmptyListPickerItem:function(){return(this.$itemList.length==0)},onInitItemInListCompleteHandler:function($item){$item.removeClass("opening").stop(true,true)},showNextItem:function(){this.currentItem++;if(this.currentItem>=this.ITEM_COUNT||this.currentItem>this.amountPickersAvailable){this.currentItem=0}this.setCurrentItem(this.currentItem)},onItemClickHandler:function(e){this.setCurrentItem($(e.currentTarget).parent(".personaje").attr("data-item-idx"))},setCurrentItem:function(itemIdx){var $currentActiveItem,$newActiveItem,$currentActiveAnimation,duration;$currentActiveItem=this.$activeItem;$newActiveItem=this.$itemList.filter("[data-item-idx="+itemIdx+"]");$newActiveItem.removeAttr("data-item-idx");$newActiveItem.stop(true,true).hide();this.doOutAnimation($newActiveItem);this.initItemInList($currentActiveItem,itemIdx);$currentActiveAnimation=this.$animationList.filter("[data-item-id="+$currentActiveItem.attr("data-item-id")+"]");$currentActiveAnimation.stop(true,true);$currentActiveAnimation.hide();this.$animationList.filter("[data-item-id="+$newActiveItem.attr("data-item-id")+"]").stop(true,true).fadeIn(200);this.currentItem=itemIdx;this.$activeItem=$newActiveItem},onItemMouseOverHandler:function(e){var $item=$(e.currentTarget);if($item.hasClass("opening")){return}this.doInAnimation($item)},doInAnimation:function($this){var $h2=$this.find(".title");$this.stop(true,true).animate({"padding-bottom":($h2.height()/2)+"px"},300);$h2.stop(true,true).animate({bottom:0},200)},onItemMouseOutHandler:function(e){this.doOutAnimation($(e.currentTarget))},doOutAnimation:function($this){var $h2=$this.find(".title");$this.stop(true,true).animate({"padding-bottom":0},300);$h2.stop(true,true).animate({bottom:-$h2.height()+"px"},200)},onItemFinish:function(){this.showNextItem()},initPickerItems:function(){var $item,itemChildrenCount=0,itemListLength=this.$itemList.length,i;for(i=0;i<itemListLength;i++){$item=this.$itemList.eq(i);if(itemChildrenCount==0){itemChildrenCount=$item.children().length+1}this.initListenerPickerItem($item);$item.hide();if(this.initActivePickerItem(i)){break}this.initItemInList($item,i)}},initListenerPickerItem:function($item){$item.find(".overlay").click($.proxy(this.onItemClickHandler,this));$item.mouseover($.proxy(this.onItemMouseOverHandler,this));$item.mouseout($.proxy(this.onItemMouseOutHandler,this))},initActivePickerItem:function(positionPickerInList){var setActivePicker=false;if(positionPickerInList>=this.ITEM_COUNT&&this.amountPickersAvailable>this.ITEM_COUNT){this.$activeItem=this.$itemList.eq(positionPickerInList),setActivePicker=true}else{if(this.amountPickersAvailable==(positionPickerInList+1)){this.$activeItem=this.$itemList.eq(0),setActivePicker=true}}return setActivePicker},initItemInList:function($item,index){var height;if($item.hasClass("opening")){return}height=$item.height();$item.attr("data-item-idx",index);$item.css({left:100/this.PICKERPLACES_IN_A1*index+"%","z-index":"auto"});$item.height(0);$item.css({display:"block",filter:"alpha(opacity=0)",opacity:0});$item.addClass("opening").animate({height:height+"px",opacity:1},500,$.proxy(this.onInitItemInListCompleteHandler,this,$item))}};(function(w,d,$,swfobj,CNConfig){function _init(embedId,width,height,scale,forceStart){var $container=$("#"+embedId),config={embedId:embedId,width:width,height:height,scale:scale||1,tooltipLogin:$container.attr("data-tooltip-login")||"",tooltipLogged:$container.attr("data-tooltip-logged")||"",clickUrlLogin:$container.attr("data-click-url-login")||"",clickUrlLogged:$container.attr("data-click-url-logged")||""};if(forceStart){_show(config)}else{$(d).on("session.status",config,_onSessionStatus)}}function _show(config){var base=CNConfig.cdnPath+"static/swf/AvatarDisplay/",mainSWF=base+"CN_30_AvatarDisplay.swf",emotions=base+"avatartools/emotions/",flashvars={mediaBasePath:emotions,defaultToonixUrl:"toonix-nologueado.swf",avatarScale:config.scale,divId:config.embedId},params={allowFullScreen:"true",allowScriptAccess:"always",scale:"noscale",salign:"tl",base:base,menu:"false",quality:"best",wmode:"transparent"};if(config.isLoggedIn){flashvars.tooltipText=config.tooltipLogged;flashvars.clickUrl=config.clickUrlLogged}else{flashvars.tooltipText=config.tooltipLogin;flashvars.clickUrl=config.clickUrlLogin}swfobj.embedSWF(mainSWF,config.embedId,config.width,config.height,"10.0.0",false,flashvars,params)}function _onSessionStatus(e,session){var config=e.data;config.isLoggedIn=session.isUserLoggedIn();_show(config)}w.AvatarDisplayController={init:_init}}(window,document,jQuery,swfobject,CNConfig));var ContentPickerController={EXTRA_TEXT:"EXTRA",GAME_TEXT:"GAME",SHOWPAGE_TEXT:"SHOWS",SOCIAL_TEXT:"SOCIAL",VIDEO_TEXT:"VIDEO",SEARCH_TEXT:"Search",$contentPicker:null,$filterContentTypeList:null,$filterSearchInput:null,$items:null,$prevItems:{content:null,page:null},$currentItems:{content:null,page:null},$nextItems:{content:null,page:null},$itemList:null,$previousBtn:null,$nextBtn:null,currentPage:0,countX:7,countY:3,itemsPerPage:null,itemsStyle:{top:[],left:[],background:[]},loading:false,serviceURL:null,queryString:null,appliedFilters:[],isFiltered:false,action:null,animateWithCSS:false,userData:null,init:function(){var tempItemsCount;this.$contentPicker=$("#contentPicker");this.$filterContentTypeList=this.$contentPicker.find(".categoriaFiltros");this.$filterSearchInput=this.$contentPicker.find(".buscador input");this.$clean=this.$contentPicker.find(".bt-x");this.$items=this.$contentPicker.find(".items");this.$previousBtn=this.$contentPicker.find(".anterior");this.$nextBtn=this.$contentPicker.find(".siguiente");this.$currentItems.content=this.$items.find(".card");this.$currentItems.page=this.currentPage;this.itemsPerPage=this.countX*this.countY;this.$contentPicker.find(".ver-todo-btn").click($.proxy(this.onAllShowsClickHandler,this));this.$filterContentTypeList.click($.proxy(this.onContentTypeButtonClickHandler,this));this.$clean.click($.proxy(this.onCleanClickHandler,this));this.$filterSearchInput.placeholder().keydown($.proxy(this.onSearchInputKeyUpHandler,this));this.$previousBtn.click($.proxy(this.onNavHandler,this));this.$nextBtn.click($.proxy(this.onNavHandler,this));this.EXTRA_TEXT=this.$contentPicker.attr("data-extra-text");this.GAME_TEXT=this.$contentPicker.attr("data-game-text");this.SHOWPAGE_TEXT=this.$contentPicker.attr("data-showpage-text");this.SOCIAL_TEXT=this.$contentPicker.attr("data-social-text");this.VIDEO_TEXT=this.$contentPicker.attr("data-video-text");this.SEARCH_TEXT=this.$contentPicker.attr("data-search-text");this.serviceURL=this.$contentPicker.attr("data-service-url");this.action="init";this.queryString=this.$filterSearchInput.val()!==""?this.$filterSearchInput.val():null;tempItemsCount=this.itemsPerPage;while(tempItemsCount--){this.itemsStyle.top[tempItemsCount]=((100/this.countY)*(Math.floor(tempItemsCount/this.countX)%this.countY))+"%";this.itemsStyle.left[tempItemsCount]=(tempItemsCount%this.countX*100/this.countX)+"%";this.itemsStyle.background[tempItemsCount]="bg-"+Math.round((Math.random()*(5-1))+1)}this.animateWithCSS=CNHelpers.detectCSSFeature("animation")&&CNHelpers.detectCSSFeature("transition")&&CNHelpers.detectCSSFeature("transform");this.arrangePage();this.$items.on("click",$.proxy(this.onItemClick,this));$(document).on("session.status",$.proxy(this.onSessionStatus,this))},onSearchInputKeyUpHandler:function(e){var queryString=this.$filterSearchInput.val();if(e.keyCode!=13){return}this.queryString=this.searchSanitize(queryString);this.currentPage=[0,1];this.isFiltered=true;this.action="init";trackSiteSearch(this.queryString,this.userData);CNLAGames.notifyAction("Sys_SearchContent");this.loadPage()},searchSanitize:function(queryString){var filters=this.appliedFilters,filters_length=filters.length,i=0,contentType;for(;i<filters_length;i++){contentType=this[filters[i].toUpperCase()+"_TEXT"];queryString=queryString.replace(new RegExp("[\\s]?"+contentType+"[\\s]?","g"),"")}queryString=queryString.replace(new RegExp("[\\s]?"+this.SEARCH_TEXT+"[\\s]?","g"),"");return queryString!==""?queryString:null},onContentTypeButtonClickHandler:function(e){this.applyFilter($(e.currentTarget).attr("data-type"))},applyFilter:function(filter){var $filter=this.$filterContentTypeList.filter("."+filter),filterPosition=$.inArray(filter,this.appliedFilters),filterText=this[filter.toUpperCase()+"_TEXT"];if(filterPosition==-1){$filter.addClass("selected");this.$filterSearchInput.val(this.$filterSearchInput.val()+" "+filterText);this.appliedFilters.push(filter)}else{$filter.removeClass("selected");this.$filterSearchInput.val(this.$filterSearchInput.val().replace(new RegExp("[\\s]?"+filterText+"[\\s]?","g")," "));this.appliedFilters.splice(filterPosition,1)}this.$filterSearchInput.val(this.$filterSearchInput.val().replace(/[\s]{1,}/," "));this.$filterSearchInput.val($.trim(this.$filterSearchInput.val()));this.$filterSearchInput.change();this.currentPage=[0,1];this.isFiltered=this.appliedFilters.length!==0;this.queryString=filter!==this.SHOWPAGE_TEXT?this.searchSanitize(this.$filterSearchInput.val()):null;this.action="init";this.loadPage()},onAllShowsClickHandler:function(e){var filter=$(e.currentTarget).attr("data-type"),$filter=this.$filterContentTypeList.filter("."+filter),filterPosition=$.inArray(filter,this.appliedFilters),filterText=this[filter.toUpperCase()+"_TEXT"];if(filterPosition==-1){this.$filterContentTypeList.removeClass("selected");this.$contentPicker.find(".ver-todo-btn").addClass("selected");this.$filterSearchInput.val(filterText);this.appliedFilters=[filter]}else{this.$contentPicker.find(".ver-todo-btn").removeClass("selected");this.$filterSearchInput.val(this.$filterSearchInput.val().replace(new RegExp("[\\s]?"+filterText+"[\\s]?","g")," "));this.appliedFilters.splice(filterPosition,1)}this.$filterSearchInput.val(this.$filterSearchInput.val().replace(/[\s]{1,}/," "));this.$filterSearchInput.val($.trim(this.$filterSearchInput.val()));this.$filterSearchInput.change();this.currentPage=[0,1];this.isFiltered=this.appliedFilters.length!==0;this.queryString=filter!==this.SHOWPAGE_TEXT?this.searchSanitize(this.$filterSearchInput.val()):null;this.action="init";this.loadPage()},onCleanClickHandler:function(e){this.$clean.hide();this.$filterContentTypeList.removeClass("selected");this.$contentPicker.find(".ver-todo-btn").removeClass("selected");this.$filterSearchInput.val("");this.appliedFilters=[];this.$filterSearchInput.change();this.currentPage=[0,1];this.isFiltered=this.appliedFilters.length!==0;this.queryString=null;this.action="init";this.loadPage()},onNavHandler:function(e){e.preventDefault();if(this.loading){return}this.action=e.currentTarget.id;if(this.action==="prev"&&this.$prevItems.content!==null){this.currentPage--;this.arrangePage()}else{if(this.action==="next"&&this.$nextItems.content!==null){this.currentPage++;this.arrangePage()}}},loadPage:function(container){this.disableFilters();var ajaxOpt={type:"GET",cache:true,url:this.serviceURL,data:{feed:CNConfig.feed,page:this.currentPage},success:$.proxy(this.onLoadPageHandler,this,container)};this.loading=true;if(typeof container!=="undefined"){$.extend(ajaxOpt.data,{page:container.page})}if(this.isFiltered||this.queryString!==null){$.extend(ajaxOpt.data,{contentTypeList:this.appliedFilters,searchQuery:this.queryString});this.$clean.show()}ajaxOpt.data=$.param(ajaxOpt.data,true);$.ajax(ajaxOpt)},disableFilters:function(){this.$filterContentTypeList.unbind("click");this.$filterSearchInput.prop("readonly",true);this.$contentPicker.find(".ver-todo-btn").unbind("click");this.$clean.unbind("click")},enableFilters:function(){this.$filterContentTypeList.click($.proxy(this.onContentTypeButtonClickHandler,this));this.$filterSearchInput.prop("readonly",false);this.$clean.click($.proxy(this.onCleanClickHandler,this));this.$contentPicker.find(".ver-todo-btn").click($.proxy(this.onAllShowsClickHandler,this))},onLoadPageHandler:function(container,data){this.enableFilters();this.loading=false;data=data&&data.length!==0?$($.trim(data)).filter(".card"):null;if(data===null){if(this.action==="init"){LightboxController.open("lightboxErrorBusqueda");if(this.$items.children().length===0){this.$filterSearchInput.val("");this.queryString=this.searchSanitize("");this.currentPage=[0,1];this.isFiltered=false;this.action="init";this.loadPage()}}return}data=this.paletteFiller(data);if(typeof container!=="undefined"){container.content=data}else{this.arrangePage(data)}},paletteFiller:function(items){var dummyItem=$("<div class='card' />"),appendDummyItem;appendDummyItem=this.itemsPerPage-items.length;while(appendDummyItem-->0){items=items.add(dummyItem.clone())}return items},arrangePage:function(data){var queryString=window.location.hash,container;if(this.action===null){return}this.$currentItems.content.remove();if(this.action==="init"&&queryString!==undefined){if(queryString.length>5){queryString=queryString.substr(2);this.doSearchWithHashParams(queryString);return}}switch(this.action){case"init":this.currentPage=0;this.$currentItems.content=typeof data!=="undefined"?data:this.paletteFiller(this.$currentItems.content);this.$nextItems.content=this.$currentItems.content.length>this.itemsPerPage?this.paletteFiller($(this.$currentItems.content.splice(this.itemsPerPage,this.itemsPerPage))):null;this.$prevItems.content=null;break;case"prev":this.$nextItems.content=this.$currentItems.content;this.$currentItems.content=this.$prevItems.content;this.$prevItems.content=null;container=this.$prevItems;break;case"next":this.$prevItems.content=this.$currentItems.content;this.$currentItems.content=this.$nextItems.content;this.$nextItems.content=null;container=this.$nextItems;break;default:break}this.$prevItems.page=this.currentPage-1;this.$currentItems.page=this.currentPage;this.$nextItems.page=this.currentPage+1;if(this.currentPage>0){this.loadPage(container)}this.action=null;this.showPage()},showPage:function(){var that=this,items=this.$currentItems.content;items.each(function(i){var $item=$(this);$item.css({display:"none",top:that.itemsStyle.top[i],left:that.itemsStyle.left[i]}).addClass(that.itemsStyle.background[i]+" loading");setTimeout($.proxy(that.onInitItemTimeOut,that,$item),Math.round((Math.random()*(600-200))+200))});this.$items.append(items)},onInitItemTimeOut:function($item){var $itemImage=$item.find(".imagen");if($itemImage.length!==0){if($itemImage.get(0).complete){this.onItemImageLoadCompleteHandler($item,$itemImage)}else{$itemImage.load($.proxy(this.onItemImageLoadCompleteHandler,this,$item,$itemImage))}}$item.fadeIn(200,(function($item){return function(){$item.removeClass("loading")}}($item)))},onItemImageLoadCompleteHandler:function($item,$itemImage){$itemImage.removeClass("loading");$item.mouseover($.proxy(this.itemZoomIn,this,$item,$itemImage));$item.mouseout($.proxy(this.itemZoomOut,this,$item,$itemImage));$itemImage.show()},onItemClick:function(e){var $target=$(e.target);if($target.is("a")){CNLAGames.notifyAction("Sys_HitCard")}},itemZoomIn:function($item,$itemImage){if($item.hasClass("loading")||$itemImage.hasClass("loading")){return}$item.addClass("over");this.$currentItems.content.not($item).css("z-index",1);$item.css("z-index",2);if(this.animateWithCSS){$item.addClass("expanded")}else{$item.stop(true).animate({height:"166px","margin-left":"-5px","margin-top":"-5px",width:"148px"},200).css("overflow","visible")}},itemZoomOut:function($item,$itemImage){if($item.hasClass("loading")||$itemImage.hasClass("loading")){return}$item.removeClass("over");if(this.animateWithCSS){$item.removeClass("expanded")}else{$item.stop(true).animate({height:"129px",margin:"5px",width:"129px"},200,function(){$item.removeClass("over");$item.css("z-index",1)})}},doSearchWithHashParams:function(queryString){window.location.hash="";this.$filterSearchInput.val(queryString);this.queryString=this.searchSanitize(queryString);this.currentPage=[0,1];this.isFiltered=true;this.action="init";this.loadPage()},onSessionStatus:function(e,session){if(session.isUserLoggedIn()){this.userData={loginStatus:"logged-in",gender:session.getUserGender(),age:session.getUserAge(),country:session.getUserRegisterCountryCode()}}}};(function($,swfobj,CNConfig){function _init(){var embedId="votatoonSWF",$embedElem=$("#"+embedId),mainSWF,configXML,width,height,clickURL,returnURL;if($embedElem.length>0){mainSWF=$embedElem.attr("data-main-swf");configXML=$embedElem.attr("data-config-xml");width=$embedElem.attr("data-width");height=$embedElem.attr("data-height");clickURL=$embedElem.attr("data-click-url");returnURL=$embedElem.attr("data-return-url");_show(mainSWF,embedId,configXML,width,height,clickURL,returnURL)}}function _show(mainSWF,embedId,configXML,width,height,clickURL,returnURL){var flashvars={configPath:configXML,country:CNConfig.feed,divId:embedId},params={allowscriptaccess:"always",allownetworking:"all",allowfullscreen:"false",wmode:"transparent"};if(typeof clickURL!=="undefined"){flashvars.clickURL=clickURL}if(typeof returnURL!=="undefined"){flashvars.returnURL=returnURL}swfobj.embedSWF(mainSWF,embedId,width,height,"10.0.0",false,flashvars,params)}_init()}(jQuery,swfobject,CNConfig));var ShowContentPlayerController={$showContentPlayer:null,$bottomCharacters:null,$bottomCharactersSlider:null,$logo:null,$currentSection:null,$contentShow:null,contenidoShowSWFContainer:null,$contentCharacter:null,$contentCharacters:null,currentCharacter:null,$contentEpisode:null,$episodiosList:null,currentEpisode:null,init:function(){this.$showContentPlayer=$("#showContentPlayer");this.$logo=this.$showContentPlayer.find(".logo");this.$logo.click($.proxy(this.onLogoClickHandler,this));this.initShow();this.initCharacters();this.initEpisodes();this.showSection(this.$contentShow);CNLAGames.notifyAction("Sys_PlayShow")},onLogoClickHandler:function(){this.showSection(this.$contentShow)},showSection:function($section){if(this.$currentSection==$section){return false}this.$contentShow.stop(true,true).hide();this.$contentCharacters.hide();this.$contentCharacter.stop(true,true).hide();this.currentCharacter=null;this.$contentEpisode.stop(true,true).hide();this.currentEpisode=null;$section.fadeIn(200);this.$currentSection=$section;return true},initShow:function(){var params={allowScriptAccess:"always",menu:"false",quality:"best",wmode:"transparent"},swf,flashVars;this.$contentShow=this.$showContentPlayer.find(".top .contenidoShow");swf=this.$contentShow.attr("data-show-swf");flashVars={video:this.$contentShow.attr("data-show-video"),showImage:this.$contentShow.attr("data-show-image"),background:this.$contentShow.attr("data-show-bkg-image")};swfobject.embedSWF(swf,"contenidoShowVideoPlayer_swf","1600","412","10.0.0",null,flashVars,params,{},$.proxy(this.swfobjectCallback,this));this.$showContentPlayer.find(".bottom .sound-btn").click($.proxy(this.onSoundButtonClickHandler,this))},onSoundButtonClickHandler:function(e){var $this=$(e.currentTarget);if($this.hasClass("unmute")){this.contenidoShowSWFContainer.muteVideo();$this.addClass("mute");$this.removeClass("unmute")}else{if($this.hasClass("mute")){this.contenidoShowSWFContainer.unmuteVideo();$this.addClass("unmute");$this.removeClass("mute")}}},initCharacters:function(){this.$contentCharacter=this.$showContentPlayer.find(".contenidoPersonaje");this.$contentCharacters=this.$contentCharacter.find(".data_personaje");this.$bottomCharacters=this.$showContentPlayer.find(".bottom .bottomPersonajes");this.$bottomCharactersSlider=this.$bottomCharacters.find(".slider");this.$bottomCharactersSlider.slider({previousArrow:".btn-preview",nextArrow:".btn-next"});this.$bottomCharactersSlider.find(".item").click($.proxy(this.onSliderItemClickHandler,this))},onSliderItemClickHandler:function(e){this.mostrarCharacter($(e.currentTarget).attr("data-item-id"))},mostrarCharacter:function(personajeId){var $currentCharacter,$descripcionCharacter;if(this.currentCharacter==personajeId){return}this.$contentCharacters.hide();this.showSection(this.$contentCharacter);$currentCharacter=this.$contentCharacters.filter("[data-item-id="+personajeId+"]");$currentCharacter.show();$descripcionCharacter=$currentCharacter.find(".descripcionPersonaje");$descripcionCharacter.stop(true,true).slideUp(0);$descripcionCharacter.slideDown(200);this.currentCharacter=personajeId},initEpisodes:function(){this.$contentEpisode=this.$showContentPlayer.find(".contenidoEpisodio");this.$episodiosList=this.$contentEpisode.find(".episodios > .item");if(this.$episodiosList.length>0){this.$showContentPlayer.find(".episodios-btn").removeClass("invisible").click($.proxy(this.onVerEpisodesClickHandler,this));this.$contentEpisode.find(".btn-preview").click($.proxy(this.onVerEpisodesPreviousPageClickHandler,this));this.$contentEpisode.find(".btn-next").click($.proxy(this.onVerEpisodesNextPageClickHandler,this))}},onVerEpisodesClickHandler:function(){if(!this.showSection(this.$contentEpisode)){return false}this.mostrarEpisodes(1)},mostrarEpisodes:function(direction){var $episodio,episodiosCount,i;this.$episodiosList.stop(true,true).hide();episodiosCount=this.$episodiosList.length;if(this.currentEpisode==null){this.currentEpisode=null}if(direction==-1){this.currentEpisode-=6;if(this.currentEpisode<0){this.currentEpisode=episodiosCount+this.currentEpisode}}for(i=0;i<3;i++){if(this.currentEpisode==null){this.currentEpisode=0}$episodio=$(this.$episodiosList.get(this.currentEpisode));$episodio.css({bottom:-$episodio.height()+"px",left:((100/3)*i)+"%"});$episodio.animate({bottom:0},{queue:false,duration:200*(i+1)});$episodio.show();this.currentEpisode++;if(this.currentEpisode>episodiosCount-1){this.currentEpisode=0}}},onVerEpisodesPreviousPageClickHandler:function(){this.mostrarEpisodes(-1)},onVerEpisodesNextPageClickHandler:function(){this.mostrarEpisodes(1)},swfobjectCallback:function(e){if(e.success){this.contenidoShowSWFContainer=e.ref}}};var UserUtilController={isValidPassword:function(password,username){if(password.length<6||password.length>10||/[\s]/.test(password)||password==username){return false}return true},isValidEmail:function(email){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email)}};