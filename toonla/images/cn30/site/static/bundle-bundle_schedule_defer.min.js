(function ($, CNConfig) {
	var $footerNav = $('.footerNav'),
		$full_schedule = $footerNav.find('#btn-full-schedule'),
		$effective_schedule = $footerNav.find('#btn-effectively-schedule'),
		$full_hd_schedule, $effective_hd_schedule;

	if (CNConfig.country === 'br') {
		$footerNav.height(70);
		$full_schedule.attr('href', 'http://turnertapkit.com/ancine?network=cnla&grid=1');
		$effective_schedule.attr('href', 'http://turnertapkit.com/ancine?network=cnla');

		$full_hd_schedule = $full_schedule.clone();
		$effective_hd_schedule = $effective_schedule.clone();

		$full_hd_schedule.attr({
				'id': 'btn-full-hd-schedule',
				'href': 'http://turnertapkit.com/ancine?network=cnhd&grid=1'
			})
			.css({
				'top': '40px',
				'left': '-250px',
				'right': 'auto',
				'font-size': '11px',
				'line-height': '30px',
				'white-space': 'nowrap'
			})
			.append('<span> (HD)</span>');

		$effective_hd_schedule.attr({
				'id': 'btn-effectively-hd-schedule',
				'href': 'http://turnertapkit.com/ancine?network=cnhd'
			})
			.css({
				'top': '40px'
			})
			.append('<span> (HD)</span>');

		$footerNav.append($full_hd_schedule);
		$footerNav.append($effective_hd_schedule);
	} 
}(jQuery, CNConfig));var ScheduleController={$schedule:null,$previousBtn:null,$nextBtn:null,$colTime:null,$colTimes:null,$colTimeList:null,$showList:null,$day1:null,$colDay1:null,$day2:null,$colDay2:null,$viewResults:null,$btnsUpDown:null,daysOfTheWeek:null,datesLoaded:{},limitMinDate:null,limitMaxDate:null,currentDateReq:{},currentDate1:null,currentDate1Str:null,currentDate2:null,currentDate2Str:null,now:null,itemFullHeight:0,firstLoadComplete:false,isPAN:false,init:function(){this.$schedule=$("#schedule");this.$previousBtn=this.$schedule.find(".topNav .btn-preview");this.$nextBtn=this.$schedule.find(".topNav .btn-next");this.$colTime=this.$schedule.find(".colTime");this.$colTimes=this.$colTime.find(".times");this.$colTimeList=this.$colTimes.find(".time");this.$showList=this.$schedule.find(".showList");this.$day1=this.$showList.find(".day1");this.$colDay1=this.$showList.find(".colLeft");this.$day2=this.$showList.find(".day2");this.$colDay2=this.$showList.find(".colRight");this.$viewResults=this.$schedule.find(".footerNav .viewResults");this.$btnsUpDown=this.$schedule.find(".footerNav .btnsUpDown");this.$previousBtn.click($.proxy(this.onPreviousButtonClickHandler,this));this.$nextBtn.click($.proxy(this.onNextButtonClickHandler,this));this.$viewResults.find(".btn-mas").click($.proxy(this.onViewResultsMasBtnClickHandler,this));this.$btnsUpDown.find(".btn-up").click($.proxy(this.onUpDownBtnUpClickHandler,this));this.$btnsUpDown.find(".btn-down").click($.proxy(this.onUpDownBtnDownClickHandler,this));this.daysOfTheWeek=this.$schedule.attr("data-daysoftheweek").split(", ");this.isPAN=(CNConfig.scheduleFeed==="CNLA_PAN");this.loadSchedule()},onPreviousButtonClickHandler:function(){this.currentDate1.setDate(this.currentDate1.getDate()-1);this.loadSchedule(this.currentDate1)},onNextButtonClickHandler:function(){this.loadSchedule(this.currentDate2)},onViewResultsMasBtnClickHandler:function(){this.$viewResults.hide();this.$btnsUpDown.show()},onUpDownBtnUpClickHandler:function(){this.$colTimes.stop(true,true);this.$colDay1.stop(true,true);this.$colDay2.stop(true,true);this.scrollSchedule(this.$colTimes.position().top+this.itemFullHeight*3)},onUpDownBtnDownClickHandler:function(){this.$colTimes.stop(true,true);this.$colDay1.stop(true,true);this.$colDay2.stop(true,true);this.scrollSchedule(this.$colTimes.position().top-this.itemFullHeight*3)},scrollSchedule:function(top,delay){if(top>=0){top=0}if(top<-this.itemFullHeight*21){top=-this.itemFullHeight*21}if(typeof delay=="undefined"){delay=200}this.$colTimes.animate({top:top+"px"},delay);this.$colDay1.animate({top:top+"px"},delay);this.$colDay2.animate({top:top+"px"},delay)},loadSchedule:function(dateFrom){var date,dateNumber;if(dateFrom==undefined){dateFrom=new Date()}date=new Date(dateFrom.getFullYear(),dateFrom.getMonth(),dateFrom.getDate());dateNumber=parseInt(date.toString("yyyyMMdd"));if(this.limitMinDate>0&&dateNumber<this.limitMinDate||this.limitMaxDate>0&&dateNumber>this.limitMaxDate){return}this.currentDate1=date;this.currentDate1Str=this.currentDate1.toString("yyyy-MM-dd");this.currentDate2=new Date(dateFrom.getFullYear(),dateFrom.getMonth(),dateFrom.getDate()+1);this.currentDate2Str=this.currentDate2.toString("yyyy-MM-dd");if(this.limitMinDate==null){this.limitMinDate=parseInt(this.currentDate1.toString("yyyyMMdd"))}if(this.limitMaxDate==null){this.currentDate1.setDate(this.currentDate1.getDate()+4);this.limitMaxDate=parseInt(this.currentDate1.toString("yyyyMMdd"));this.currentDate1.setDate(this.currentDate1.getDate()-4)}this.loadColumn(1);this.loadColumn(2)},loadColumn:function(i){var date,dateStr,from,to;date=this["currentDate"+i];dateStr=this["currentDate"+i+"Str"];this["$day"+i].text(this.daysOfTheWeek[date.getDay()]+" "+date.getDate());this["$colDay"+i].addClass("loading");if(typeof this.datesLoaded[dateStr]!="undefined"){this.onPageLoadedCompleteHandler(i,dateStr,this.datesLoaded[dateStr])}else{if(typeof this.currentDateReq[dateStr]=="undefined"){from=this.isPAN?moment.tz(dateStr+"T00:00:00",CNConfig.feedTimezoneID).tz(CNConfig.scheduleTimezoneID).format("YYYY-MM-DDTHH:mm:ss"):moment.tz(dateStr+"T00:00:00",CNConfig.feedTimezoneID).format("YYYY-MM-DDTHH:mm:ss");to=this.isPAN?moment.tz(dateStr+"T23:59:59",CNConfig.feedTimezoneID).tz(CNConfig.scheduleTimezoneID).format("YYYY-MM-DDTHH:mm:ss"):moment.tz(dateStr+"T23:59:59",CNConfig.feedTimezoneID).format("YYYY-MM-DDTHH:mm:ss");this.currentDateReq[dateStr]=$.ajax({url:"http://schedule.turner.com/schedule",data:{feed:CNConfig.scheduleFeed,from:from,to:to,output:"json",mapped:"true"},dataType:"jsonp",jsonpCallback:"scheduleColumn"+i,cache:true,success:$.proxy(this.onPageLoadedCompleteHandler,this,i,dateStr)})}else{setTimeout($.proxy(this.loadColumn,this,i),1)}}},onPageLoadedCompleteHandler:function(column,dateStr,data){var $column,$nowHour,now,nowDate,nowHour,nowMinutes,htmlShows,schedHour,schedHourTxt,previousShow,featuredHour,intervals,intervalsStr,interval,i,dataLength;if(!data){return}if(typeof this.datesLoaded[dateStr]=="undefined"){this.datesLoaded[dateStr]=data}if(dateStr!=this["currentDate"+column+"Str"]){return}data=data["com.turner.dmtla.schedule.dto.ScheduleDTO"];data=data.feeds[0];data=data["com.turner.dmtla.schedule.dto.FeedDTO"];data=data.shows[0];data=data["com.turner.dmtla.schedule.dto.ShowDTO"];$column=this["$colDay"+column];CNLALibrary.getTime({type:"country",country:CNConfig.feed},$.proxy(function(data){this.now=data},this));nowDate=this.now.format("YYYY-MM-DD");nowHour=this.now.hours();nowMinutes=this.now.minutes();htmlShows="";schedHour=0;previousShow=null;featuredHour=null;intervals=[0,15,30,45];intervalsStr=["00","15","30","45"];dataLength=data.length;if(this.isPAN){for(i=0;i<dataLength;i++){data[i].airDateTime=moment.tz(data[i].airDateTime,CNConfig.scheduleTimezoneID);data[i].airDateTime=data[i].airDateTime.tz(CNConfig.feedTimezoneID).format("YYYY-MM-DDTHH:mm:ss")}}for(i=0;i<dataLength;i++){htmlShows+='<div class="tvPrograms">';schedHourTxt=schedHour.toString();if(schedHour<10){schedHourTxt="0"+schedHour.toString()}interval=0;while(i<dataLength){data[i].airTimeStr=data[i].airDateTime.substring(11,16);data[i].airTime=parseInt(data[i].airTimeStr);data[i].airHourStr=data[i].airTimeStr.substring(0,2);data[i].airHour=parseInt(data[i].airHourStr);data[i].airMinutesStr=data[i].airTimeStr.substring(3,5);data[i].airMinutes=parseInt(data[i].airMinutesStr);data[i].dataHora=data[i].airHourStr+data[i].airMinutesStr;if(nowDate==dateStr){if(data[i].airHour<=nowHour){if(data[i].airMinutes<=nowMinutes){featuredHour=data[i].dataHora}}}if(data[i].airHourStr!=schedHourTxt){schedHour++;break}if(data[i].airMinutes>intervals[interval]&&intervals[interval]!=45){if(previousShow){if(intervals[interval]==0){htmlShows+='<div class="item" data-hora="'+previousShow.dataHora+'"><p><span class="txtprogram">'+previousShow.title+"</span>"+previousShow.airHourStr+":"+intervalsStr[interval]+"</p></div>"}else{htmlShows+='<div class="item" data-hora="'+previousShow.dataHora+'"><p>'+data[i].airHourStr+":"+intervalsStr[interval]+"</p></div>"}}else{htmlShows+='<div class="item" data-hora="'+data[i].dataHora+'"><p>'+data[i].airHourStr+":"+intervalsStr[interval]+"</p></div>"}interval++;continue}previousShow=data[i];htmlShows+='<div class="item" data-hora="'+data[i].dataHora+'"><p><span class="txtprogram">'+data[i].title+"</span>"+data[i].airTimeStr+'</p><div class="cb"></div></div>';interval++;i++}for(interval;interval<4;interval++){if(previousShow){if(intervals[interval]==0){htmlShows+='<div class="item" data-hora="'+previousShow.dataHora+'"><p><span class="txtprogram">'+previousShow.title+"</span>"+previousShow.airHourStr+":"+previousShow.airMinutesStr+"</p></div>"}else{htmlShows+='<div class="item" data-hora="'+previousShow.dataHora+'"><p>'+schedHourTxt+":"+intervalsStr[interval]+"</p></div>"}}else{htmlShows+='<div class="item" data-hora="'+schedHourTxt+'"><p>'+schedHourTxt+":"+intervalsStr[interval]+"</p></div>"}}i--;htmlShows+="</div>"}$column.html(htmlShows).removeClass("loading");this.$colTimeList.removeClass("time_2").addClass("time_1");$nowHour=this.$colTimeList.filter("[data-hora="+nowHour+"]");$nowHour.removeClass("time_1").addClass("time_2");if(nowDate==dateStr&&featuredHour!=null){$column.find("[data-hora="+featuredHour.replace(":",":")+"]").addClass("destacado")}if(!this.firstLoadComplete){this.itemFullHeight=$column.find(".tvPrograms").outerHeight(true);this.$colTime.css("visibility","visible");this.firstLoadComplete=true;this.scrollSchedule(-$nowHour.position().top,0)}}};ScheduleController.init();new LightboxRecuperaDatosController("#lightboxUsuarioInexistente").init();new LightboxRecuperaDatosController("#lightboxRecuperaDatos").init();LightboxCreditsPopupController.init();